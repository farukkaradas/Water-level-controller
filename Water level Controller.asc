Version 4
SHEET 1 2088 1748
WIRE 1536 -16 1504 -16
WIRE 1648 -16 1616 -16
WIRE 240 48 240 32
WIRE 896 48 496 48
WIRE 1392 48 1360 48
WIRE 1504 48 1504 -16
WIRE 1504 48 1472 48
WIRE 992 64 960 64
WIRE -112 96 -144 96
WIRE 496 96 496 48
WIRE 496 96 480 96
WIRE 512 96 496 96
WIRE 640 96 592 96
WIRE 720 96 640 96
WIRE 816 96 784 96
WIRE 896 96 816 96
WIRE -144 112 -144 96
WIRE 720 112 688 112
WIRE 1504 112 1504 48
WIRE 1536 112 1504 112
WIRE 688 128 688 112
WIRE 1648 128 1648 -16
WIRE 1648 128 1600 128
WIRE 1680 128 1648 128
WIRE 1392 144 1360 144
WIRE 1504 144 1472 144
WIRE 1536 144 1504 144
WIRE 176 160 112 160
WIRE 240 160 240 128
WIRE 240 160 176 160
WIRE 640 160 640 96
WIRE 640 160 624 160
WIRE 816 160 816 96
WIRE 832 160 816 160
WIRE 1504 160 1504 144
WIRE 1568 176 1568 160
WIRE 240 208 240 160
WIRE 176 224 112 224
WIRE 208 224 176 224
WIRE 1504 256 1504 240
WIRE 176 288 112 288
WIRE 208 320 208 224
WIRE 240 320 240 288
WIRE 240 320 208 320
WIRE 176 368 176 288
WIRE 240 368 240 320
WIRE 1344 368 1328 368
WIRE 1440 368 1424 368
WIRE 1472 368 1440 368
WIRE 1568 368 1552 368
WIRE 1632 368 1568 368
WIRE 1568 384 1568 368
WIRE 1440 400 1440 368
WIRE 704 416 672 416
WIRE 880 416 784 416
WIRE 896 416 880 416
WIRE 880 432 880 416
WIRE 1584 464 1568 464
WIRE 176 480 176 432
WIRE 240 480 240 432
WIRE 1216 672 1200 672
WIRE 1328 672 1296 672
WIRE -16 688 -48 688
WIRE 112 688 64 688
WIRE -144 768 -160 768
WIRE -48 768 -48 688
WIRE -48 768 -144 768
WIRE -16 768 -48 768
WIRE 1088 768 1040 768
WIRE 1200 768 1200 672
WIRE 1200 768 1168 768
WIRE 1248 768 1200 768
WIRE 1328 768 1328 672
WIRE 1328 768 1312 768
WIRE 1360 768 1328 768
WIRE -144 784 -144 768
WIRE 112 784 112 688
WIRE 112 784 48 784
WIRE 544 784 544 720
WIRE -16 800 -48 800
WIRE 1248 800 1200 800
WIRE 1360 800 1312 800
WIRE 1200 816 1200 800
WIRE 400 832 384 832
WIRE -48 912 -48 800
WIRE -48 912 -96 912
WIRE 0 912 -48 912
WIRE 112 912 112 784
WIRE 112 912 80 912
WIRE 544 912 544 880
WIRE 560 912 544 912
WIRE 544 928 544 912
WIRE -96 1280 -224 1280
WIRE 16 1280 -96 1280
WIRE 480 1280 16 1280
WIRE 704 1280 480 1280
WIRE -96 1296 -96 1280
WIRE 16 1296 16 1280
WIRE 480 1296 480 1280
WIRE 240 1312 224 1312
WIRE 704 1312 704 1280
WIRE 1312 1312 1296 1312
WIRE 1424 1312 1392 1312
WIRE 1440 1312 1424 1312
WIRE 1536 1312 1520 1312
WIRE 240 1328 192 1328
WIRE 336 1328 304 1328
WIRE 1536 1328 1536 1312
WIRE 224 1344 224 1312
WIRE 240 1344 224 1344
WIRE 240 1360 208 1360
WIRE 1424 1360 1424 1312
WIRE 1648 1360 1616 1360
WIRE 112 1376 32 1376
WIRE 192 1376 192 1328
WIRE 192 1376 176 1376
WIRE 224 1376 224 1344
WIRE 240 1376 224 1376
WIRE 400 1376 400 1328
WIRE 416 1376 400 1376
WIRE 432 1376 416 1376
WIRE 1424 1376 1424 1360
WIRE 1440 1376 1424 1376
WIRE 224 1392 224 1376
WIRE 256 1392 256 1376
WIRE 256 1392 224 1392
WIRE 112 1408 96 1408
WIRE 192 1408 176 1408
WIRE 256 1408 256 1392
WIRE 480 1408 480 1392
WIRE 704 1408 704 1376
WIRE 704 1408 480 1408
WIRE 736 1408 704 1408
WIRE 848 1408 736 1408
WIRE 944 1408 928 1408
WIRE 1296 1408 1024 1408
WIRE 1328 1408 1296 1408
WIRE 1440 1408 1328 1408
WIRE 1552 1408 1504 1408
WIRE 32 1424 32 1376
WIRE 32 1424 -80 1424
WIRE 96 1424 96 1408
WIRE 112 1424 96 1424
WIRE 480 1424 480 1408
WIRE 112 1440 112 1424
WIRE 240 1440 224 1440
WIRE 704 1440 704 1408
WIRE 192 1456 192 1408
WIRE 240 1456 192 1456
WIRE 336 1456 304 1456
WIRE 1296 1456 1296 1408
WIRE 224 1472 224 1440
WIRE 240 1472 224 1472
WIRE 1616 1472 1616 1456
WIRE -32 1488 -80 1488
WIRE 64 1488 48 1488
WIRE 208 1488 208 1360
WIRE 208 1488 64 1488
WIRE 240 1488 208 1488
WIRE 224 1504 224 1472
WIRE 240 1504 224 1504
WIRE 400 1504 400 1456
WIRE 416 1504 400 1504
WIRE 432 1504 416 1504
WIRE 224 1520 224 1504
WIRE 256 1520 256 1504
WIRE 256 1520 224 1520
WIRE 256 1536 256 1520
WIRE 480 1536 480 1520
WIRE 704 1536 704 1504
WIRE 64 1584 64 1488
WIRE 80 1584 64 1584
FLAG 176 480 0
FLAG 240 480 0
FLAG -112 224 Clock
IOPIN -112 224 Out
FLAG 176 224 trigger
FLAG 176 160 discharge
FLAG -144 112 0
FLAG 480 96 Clock
IOPIN 480 96 In
FLAG 640 224 0
FLAG 832 160 Digital_Delayed_signal
FLAG 992 64 Delay_signal
IOPIN 992 64 Out
FLAG 624 160 Delayed_signal
FLAG 880 496 0
FLAG 672 416 Delay_signal
IOPIN 672 416 In
FLAG 896 416 Dc_signal
IOPIN 896 416 Out
FLAG 1680 128 V_Error
IOPIN 1680 128 Out
FLAG 1360 48 Dc_signal
IOPIN 1360 48 In
FLAG -272 480 0
FLAG -272 400 VCC
IOPIN -272 400 Out
FLAG 688 128 0
FLAG 1568 544 0
FLAG 1632 368 V_pot
IOPIN 1632 368 Out
FLAG 1360 144 V_pot
IOPIN 1360 144 In
FLAG 1584 464 pot_gnd
FLAG 1440 400 pot_vcc
FLAG -160 480 0
FLAG 1568 96 VCC
IOPIN 1568 96 In
FLAG 1328 368 VCC
IOPIN 1328 368 In
FLAG 1504 256 0
FLAG -160 400 VCC-
IOPIN -160 400 Out
FLAG 112 96 VCC
IOPIN 112 96 In
FLAG -112 288 VCC
IOPIN -112 288 In
FLAG -112 160 trigger
IOPIN -112 160 BiDir
FLAG 240 32 VCC
IOPIN 240 32 In
FLAG 1040 768 tri_in
IOPIN 1040 768 In
FLAG 1360 768 C1_PosFB
FLAG 1248 816 0
FLAG -48 976 0
FLAG -144 864 0
FLAG -96 912 Triangular
IOPIN -96 912 Out
FLAG 16 816 VCC
IOPIN 16 816 In
FLAG -240 768 VCC
IOPIN -240 768 In
FLAG 16 752 0
FLAG 1200 896 V_Error
IOPIN 1200 896 In
FLAG 736 1408 Mdrv
FLAG 256 1408 0
FLAG 336 1472 0
FLAG 336 1344 0
FLAG 416 1376 G1
FLAG 416 1504 G2
FLAG 256 1536 0
FLAG 1296 1536 0
FLAG 480 1536 0
FLAG -224 1360 0
FLAG -96 1280 Vpwr
FLAG 112 1440 0
FLAG 1440 1424 0
FLAG 1536 1328 0
FLAG 1328 1408 Vrcs
FLAG -96 1360 0
FLAG 16 1360 0
FLAG 1648 1360 nOverC
IOPIN 1648 1360 Out
FLAG 1616 1472 0
FLAG 704 1536 0
FLAG 1360 800 PWM
IOPIN 1360 800 Out
FLAG -80 1424 PWM
IOPIN -80 1424 In
FLAG 544 1008 0
FLAG 544 720 VCC
IOPIN 544 720 In
FLAG 560 912 tri_in
IOPIN 560 912 Out
FLAG 384 832 Triangular
IOPIN 384 832 In
FLAG 1568 176 VCC-
IOPIN 1568 176 In
FLAG 80 1584 nOverC
IOPIN 80 1584 In
FLAG 1296 1312 VCC
IOPIN 1296 1312 In
FLAG -80 1488 VCC
IOPIN -80 1488 In
FLAG 1424 1360 204mv
SYMBOL Misc\\NE555 0 192 R0
SYMATTR InstName U1
SYMBOL res 224 32 R0
SYMATTR InstName R1
SYMATTR Value 30k
SYMATTR SpiceLine tol=3 pwr=2
SYMBOL res 224 192 R0
SYMATTR InstName R2
SYMATTR Value 470k
SYMATTR SpiceLine tol=3 pwr=2
SYMBOL cap 192 432 R180
WINDOW 0 24 56 Left 2
WINDOW 3 24 8 Left 2
SYMATTR InstName C1
SYMATTR Value 10n
SYMATTR SpiceLine V=25
SYMBOL cap 256 432 R180
WINDOW 0 24 56 Left 2
WINDOW 3 24 8 Left 2
SYMATTR InstName C2
SYMATTR Value 10p
SYMATTR SpiceLine V=25
SYMBOL res 608 80 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R3
SYMATTR Value 1k
SYMBOL cap 624 160 R0
SYMATTR InstName C_sensor
SYMATTR Value 80p
SYMBOL Digital\\xor 944 16 R0
SYMATTR InstName XOR
SYMATTR SpiceLine Vhigh=5
SYMBOL cap 864 432 R0
WINDOW 0 -35 16 Left 2
WINDOW 3 -34 48 Left 2
SYMATTR InstName C3
SYMATTR Value 1µ
SYMATTR SpiceLine V=6.3 Irms=0 Rser=0 Lser=0 mfg="Murata" pn="GRM155R70J105MA12" type="X7R"
SYMBOL res 800 400 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R5
SYMATTR Value 150
SYMATTR SpiceLine tol=1 pwr=0.1
SYMBOL voltage -272 384 R0
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
SYMATTR InstName V+
SYMATTR Value 5
SYMBOL Digital\\xor 768 48 R0
SYMATTR InstName A1
SYMATTR Value2 Vhigh=5
SYMBOL res 1568 352 R90
WINDOW 0 -2 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName RH
SYMATTR Value 1
SYMBOL res 1584 480 R180
WINDOW 0 -36 73 Left 2
WINDOW 3 -46 47 Left 2
SYMATTR InstName RL
SYMATTR Value 10K
SYMATTR SpiceLine tol=1 pwr=0.1
SYMBOL res 1488 128 R90
WINDOW 0 -2 63 VBottom 2
WINDOW 3 31 64 VTop 2
SYMATTR InstName R6
SYMATTR Value 1k
SYMBOL res 1488 32 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R16
SYMATTR Value 1k
SYMBOL Opamps\\LT1001 1568 64 R0
WINDOW 3 30 83 Left 2
SYMATTR InstName U2
SYMBOL res 1632 -32 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R14
SYMATTR Value 22k
SYMBOL res 1520 256 R180
WINDOW 0 36 56 Left 2
WINDOW 3 38 34 Left 2
SYMATTR InstName R15
SYMATTR Value 22k
SYMBOL voltage -160 384 R0
WINDOW 0 26 21 Left 2
WINDOW 3 37 87 Left 2
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
SYMATTR InstName V-
SYMATTR Value -5
SYMBOL res 1552 448 R0
WINDOW 0 36 53 Left 2
SYMATTR InstName R_GND
SYMATTR Value 5.7k
SYMATTR SpiceLine tol=1 pwr=0.1
SYMBOL res 1440 352 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R_VCC
SYMATTR Value 162K
SYMATTR SpiceLine tol=1 pwr=0.1
SYMBOL diffschmitt 1248 720 R0
WINDOW 0 -19 17 Left 2
WINDOW 3 8 120 Invisible 2
SYMATTR InstName Comp1
SYMATTR Value Ref=0 Vhigh=5 Trise=10n Td=20n
SYMBOL res 1312 656 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R4
SYMATTR Value 10k
SYMATTR SpiceLine tol=3
SYMBOL res 1184 800 R0
WINDOW 0 -30 38 Left 2
WINDOW 3 -34 64 Left 2
SYMATTR InstName R7
SYMATTR Value 1k
SYMATTR SpiceLine tol=3
SYMBOL res 1184 752 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 29 81 VTop 2
SYMATTR InstName R8
SYMATTR Value 1k
SYMATTR SpiceLine tol=3
SYMBOL res -32 672 M90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R9
SYMATTR Value 500
SYMATTR SpiceLine tol=1 pwr=0.1
SYMBOL res -16 896 M90
WINDOW 0 -1 73 VBottom 2
WINDOW 3 36 74 VTop 2
SYMATTR InstName R10
SYMATTR Value 500
SYMATTR SpiceLine tol=1 pwr=0.1
SYMBOL cap -32 912 M0
WINDOW 0 -33 28 Left 2
WINDOW 3 -32 51 Left 2
SYMATTR InstName C4
SYMATTR Value 1n
SYMBOL res -144 784 M270
WINDOW 0 32 56 VTop 2
WINDOW 3 0 56 VBottom 2
SYMATTR InstName R11
SYMATTR Value 100K
SYMATTR SpiceLine tol=1 pwr=0.1
SYMBOL res -160 880 M180
WINDOW 0 36 76 Left 2
WINDOW 3 36 40 Left 2
SYMATTR InstName R13
SYMATTR Value 100K
SYMATTR SpiceLine tol=1 pwr=0.1
SYMBOL nmos 432 1424 R0
WINDOW 3 52 60 Left 2
WINDOW 0 52 32 Left 2
SYMATTR Value FDS4410
SYMATTR InstName M1
SYMBOL nmos 432 1296 R0
WINDOW 3 55 58 Left 2
WINDOW 0 52 32 Left 2
SYMATTR Value FDS4410
SYMATTR InstName M2
SYMBOL Digital\\buf1 336 1264 R0
WINDOW 0 -5 38 Left 2
WINDOW 3 8 60 Invisible 2
SYMATTR InstName MD1
SYMATTR Value Ref=2.5 Vhigh=15 Trise=50n Td=10n
SYMBOL Digital\\and 272 1280 R0
WINDOW 0 -24 63 Left 2
WINDOW 3 16 52 Invisible 2
SYMATTR InstName A2
SYMATTR Value Vhigh=5 Trise=100n Tfall=10n Td=10n
SYMBOL Digital\\and 272 1408 R0
WINDOW 0 -24 64 Left 2
WINDOW 3 16 52 Invisible 2
SYMATTR InstName A3
SYMATTR Value Vhigh=5 Trise=100n Tfall=10n Td=10n
SYMBOL ind 832 1424 R270
WINDOW 0 60 49 VTop 2
WINDOW 3 35 40 VTop 2
SYMATTR InstName Lm1
SYMATTR Value 1m
SYMBOL res 928 1424 R270
WINDOW 0 59 54 VTop 2
WINDOW 3 60 42 VBottom 2
SYMATTR InstName Rmotor
SYMATTR Value 4
SYMBOL Digital\\buf1 336 1392 R0
WINDOW 0 -5 38 Left 2
WINDOW 3 8 60 Invisible 2
SYMATTR InstName MD2
SYMATTR Value Ref=2.5 Vhigh=5 Trise=50n Td=10n
SYMBOL voltage -224 1264 R0
WINDOW 0 37 51 Left 2
WINDOW 123 0 0 Left 2
WINDOW 39 0 0 Left 2
WINDOW 3 36 71 Left 2
SYMATTR InstName Vpwr1
SYMATTR Value 10V
SYMBOL Digital\\diffschmitt 112 1328 R0
WINDOW 3 8 120 Invisible 2
WINDOW 0 23 34 Left 2
SYMATTR Value Vhigh=5 Trise=10n Td=10n
SYMATTR InstName A4
SYMBOL res 1312 1440 M0
WINDOW 0 36 45 Left 2
WINDOW 3 36 67 Left 2
SYMATTR InstName Rcs
SYMATTR Value 0.1
SYMBOL Digital\\diffschmitt 1440 1328 R0
WINDOW 3 8 120 Invisible 2
WINDOW 0 23 34 Left 2
SYMATTR Value Vt=0 Vh=1m Vhigh=5 Trise=10n Td=10n
SYMATTR InstName A5
SYMBOL polcap -112 1296 R0
WINDOW 0 42 13 Left 2
WINDOW 3 37 35 Left 2
SYMATTR InstName C5
SYMATTR Value 100µ
SYMATTR Description Capacitor
SYMATTR Type cap
SYMATTR SpiceLine V=25 Irms=370m Rser=0.24 Lser=0 mfg="Nichicon" pn="UPL1E101MPH" type="Al electrolytic"
SYMBOL cap 0 1296 R0
WINDOW 0 41 12 Left 2
WINDOW 3 39 35 Left 2
SYMATTR InstName C6
SYMATTR Value 100n
SYMBOL res 64 1504 M270
WINDOW 0 30 71 VTop 2
WINDOW 3 30 36 VTop 2
SYMATTR InstName R12
SYMATTR Value 1k
SYMBOL res 1536 1328 M270
WINDOW 0 59 63 VTop 2
WINDOW 3 34 64 VTop 2
SYMATTR InstName R17
SYMATTR Value 200
SYMATTR SpiceLine tol=1 pwr=0.1
SYMBOL npn 1552 1360 R0
WINDOW 0 -110 92 Left 2
WINDOW 3 -130 114 Left 2
SYMATTR InstName Q1
SYMATTR Value BC547B
SYMBOL res 1408 1328 M270
WINDOW 0 56 59 VTop 2
WINDOW 3 33 57 VTop 2
SYMATTR InstName R18
SYMATTR Value 4.75K
SYMATTR SpiceLine tol=1 pwr=0.1
SYMBOL schottky 688 1376 M180
WINDOW 0 39 32 Left 2
WINDOW 3 21 9 Left 2
SYMATTR InstName D1
SYMATTR Value 1N5819
SYMATTR Description Diode
SYMATTR Type diode
SYMBOL schottky 688 1504 M180
WINDOW 0 39 32 Left 2
WINDOW 3 21 9 Left 2
SYMATTR InstName D2
SYMATTR Value 1N5819
SYMATTR Description Diode
SYMATTR Type diode
SYMBOL npn 480 784 R0
SYMATTR InstName Q2
SYMATTR Value BC547B
SYMBOL res 528 912 R0
SYMATTR InstName R19
SYMATTR Value 1k
SYMATTR SpiceLine tol=3 pwr=2
SYMBOL res 496 816 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R20
SYMATTR Value 100
SYMATTR SpiceLine tol=1 pwr=0.1
SYMBOL Opamps\\LT1001 16 848 M180
SYMATTR InstName U4
TEXT -96 -64 Left 2 ;Oscillator with 555
TEXT 640 -72 Left 2 ;Obtaining Delay signal
TEXT 1408 -72 Left 2 ;Error Amplifier
TEXT 1432 312 Left 2 ;Potentiometer
TEXT 592 312 Left 2 ;Obtaining DC water level signal
TEXT 1136 608 Left 2 ;PWM Generation
TEXT -192 608 Left 2 ;Triangular wave generation
TEXT 664 240 Left 2 ;for 5 cm value of capacitor is 120 pf \nfor 15 cm value of capacitor is 250 pf
TEXT 64 1528 Left 2 ;Enable input
TEXT 832 1432 Left 2 !.ic I(Lm)=0
TEXT -160 1144 Left 2 ;Half Bridge Driver:\nTwo or more of the drivers in driver IC can be \nused in parallel to increase current output.
TEXT 816 1280 Left 2 ;Inductive load that \nmodels motor winding.
TEXT 1320 1112 Left 2 ;Over-current protection:\nVoltage on Rcs current-sense \nresistor is compared with the \nthreshold set by R18 and R17.
TEXT 1360 1504 Left 2 ;LM311 or LM393 comparator \nwith open-collector output
TEXT 696 1120 Left 2 ;D1 and D2 are required to circulate the \nload current when both of the driver \ntransistors are OFF.  Otherwise, voltage \nat Mdrv can be very high due to Lm*di/dt.
TEXT -352 1688 Left 2 !.tran 0 0.75m 0.1m uic
TEXT 344 608 Left 2 ;Emitter-follower
LINE Normal 1184 288 368 288 2
LINE Normal 1808 288 1184 288 2
LINE Normal -320 1072 -320 576 2
LINE Normal 1808 576 1808 1072 2
LINE Normal 1808 1072 -320 1072 2
LINE Normal 224 1072 224 576 2
LINE Normal 1200 1648 672 1648 2
LINE Normal 672 1072 672 576 2
RECTANGLE Normal -320 576 368 -96 2
RECTANGLE Normal 1184 576 368 -96 2
RECTANGLE Normal 1808 576 1184 -96 2
RECTANGLE Normal 1072 1472 816 1328 1
RECTANGLE Normal 1200 1648 1808 1072 2
RECTANGLE Normal 672 1648 -320 1072 2
